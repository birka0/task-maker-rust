<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="The protocol related structs and enums."><meta name="keywords" content="rust, rustlang, rust-lang, proto"><title>task_maker_exec::proto - Rust</title><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled ><script id="default-settings"></script><script src="../../storage.js"></script><script src="../../crates.js"></script><noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="icon" type="image/svg+xml" href="../../favicon.svg">
<link rel="alternate icon" type="image/png" href="../../favicon-16x16.png">
<link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><style type="text/css">#crate-search{background-image:url("../../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../../task_maker_exec/index.html'><div class='logo-container rust-logo'><img src='../../rust-logo.png' alt='logo'></div></a><h2 class="location">Module proto</h2><div class="sidebar-elems"><div class="block items"><ul><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li></ul></div><div id="sidebar-vars" data-name="proto" data-ty="mod" data-relpath="./"></div><script defer src="./sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img src="../../brush.svg" width="18" height="18" alt="Pick another theme!"></button><div id="theme-choices" role="menu"></div></div><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../../settings.html" title="settings"><img src="../../wheel.svg" width="18" height="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Module <a href="../index.html">task_maker_exec</a>::<wbr><a class="mod" href="#">proto</a><button id="copy-path" onclick="copy_path(this)" title="copy path"><img src="../../clipboard.svg" width="19" height="18" alt="Copy item import" title="Copy item import to clipboard"></button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../../src/task_maker_exec/proto.rs.html#1-215" title="goto source code">[src]</a></span></h1><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>The protocol related structs and enums.</p>
<h1 id="protocol-specification" class="section-header"><a href="#protocol-specification">Protocol Specification</a></h1>
<p>The communication between the services is done using the abstraction of
<code>std::sync::mpsc::channel</code>. The messages are serialized and then sent inside a <code>channel</code>. The
way the messages are serialized is unspecified and
<a href="../../task_maker_exec/fn.serialize_into.html"><code>serialize_into</code></a>/<a href="../../task_maker_exec/fn.deserialize_from.html"><code>deserialize_from</code></a>
should be used instead of reading from / writing to the channels.</p>
<p>There are 3 basic actors in the protocol:</p>
<ul>
<li>The Client: the one who makes the DAG and is interested in the results;</li>
<li>The Server: the one who manages the execution of the DAGs;</li>
<li>The Worker: the one who is able to run an <code>Execution</code> inside a <code>Sandbox</code>.</li>
</ul>
<p>The clients are able to communicate to the server, the workers are able to communicate to the
server and the server is able to communicate with both. The clients and the workers should not
communicate directly.</p>
<p>The 4 valid communication directions are:</p>
<ul>
<li><code>Client</code> — <a href="enum.ExecutorClientMessage.html"><code>ExecutorClientMessage</code></a> → <code>Server</code></li>
<li><code>Client</code> ← <a href="enum.ExecutorServerMessage.html"><code>ExecutorServerMessage</code></a> — <code>Server</code></li>
<li><code>Worker</code> — <a href="enum.WorkerClientMessage.html"><code>WorkerClientMessage</code></a> → <code>Server</code></li>
<li><code>Worker</code> ← <a href="enum.WorkerServerMessage.html"><code>WorkerServerMessage</code></a> — <code>Server</code></li>
</ul>
<p>When an actor needs a file a particular series of messages is sent. Let’s assume <code>A</code> wants a
file from <code>B</code>:</p>
<ul>
<li><code>A</code> sends a <code>AskFile</code> to <code>B</code></li>
<li><code>B</code> answers with <code>ProvideFile</code> which triggers a protocol switch for sending the file</li>
<li><code>B</code> sends raw data (<code>send_raw</code>) zero or more times</li>
<li><code>B</code> sends empty raw data which triggers a protocol switch, back into normal mode</li>
</ul>
</div></details><h2 id="structs" class="section-header"><a href="#structs">Structs</a></h2>
<table><tr class="module-item"><td><a class="struct" href="struct.ChannelFileIterator.html" title="task_maker_exec::proto::ChannelFileIterator struct">ChannelFileIterator</a></td><td class="docblock-short"><p>An iterator over the byte chunks sent during the file transfer mode in a channel.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.ChannelFileSender.html" title="task_maker_exec::proto::ChannelFileSender struct">ChannelFileSender</a></td><td class="docblock-short"><p>Utility function to send a file to a channel using <a href="https://docs.rs/ductile/0.1.0/ductile/struct.ChannelSender.html#method.send_raw"><code>send_raw</code></a>.</p>
</td></tr></table><h2 id="enums" class="section-header"><a href="#enums">Enums</a></h2>
<table><tr class="module-item"><td><a class="enum" href="enum.ExecutorClientMessage.html" title="task_maker_exec::proto::ExecutorClientMessage enum">ExecutorClientMessage</a></td><td class="docblock-short"><p>Messages that the client sends to the server.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.ExecutorServerMessage.html" title="task_maker_exec::proto::ExecutorServerMessage enum">ExecutorServerMessage</a></td><td class="docblock-short"><p>Messages that the server sends to the client.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.WorkerClientMessage.html" title="task_maker_exec::proto::WorkerClientMessage enum">WorkerClientMessage</a></td><td class="docblock-short"><p>Messages sent by the workers to the server.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.WorkerServerMessage.html" title="task_maker_exec::proto::WorkerServerMessage enum">WorkerServerMessage</a></td><td class="docblock-short"><p>Messages sent by the server to the worker.</p>
</td></tr></table></section><section id="search" class="content hidden"></section><div id="rustdoc-vars" data-root-path="../../" data-current-crate="task_maker_exec" data-search-index-js="../../search-index.js" data-search-js="../../search.js"></div><script src="../../main.js"></script></body></html>