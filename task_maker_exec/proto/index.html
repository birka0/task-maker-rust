<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `proto` mod in crate `task_maker_exec`."><meta name="keywords" content="rust, rustlang, rust-lang, proto"><title>task_maker_exec::proto - Rust</title><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../dark.css"><link rel="stylesheet" type="text/css" href="../../light.css" id="themeStyle"><script src="../../storage.js"></script><noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="shortcut icon" href="../../favicon.ico"><style type="text/css">#crate-search{background-image:url("../../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu">&#9776;</div><a href='../../task_maker_exec/index.html'><div class='logo-container'><img src='../../rust-logo.png' alt='logo'></div></a><p class='location'>Module proto</p><div class="sidebar-elems"><div class="block items"><ul><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li></ul></div><p class='location'><a href='../index.html'>task_maker_exec</a></p><script>window.sidebarCurrent = {name: 'proto', ty: 'mod', relpath: '../'};</script><script defer src="../sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!"><img src="../../brush.svg" width="18" alt="Pick another theme!"></button><div id="theme-choices"></div></div><script src="../../theme.js"></script><nav class="sub"><form class="search-form js-only"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><a id="settings-menu" href="../../settings.html"><img src="../../wheel.svg" width="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class='fqn'><span class='out-of-band'><span id='render-detail'><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class='inner'>&#x2212;</span>]</a></span><a class='srclink' href='../../src/task_maker_exec/proto.rs.html#1-217' title='goto source code'>[src]</a></span><span class='in-band'>Module <a href='../index.html'>task_maker_exec</a>::<wbr><a class="mod" href=''>proto</a></span></h1><div class='docblock'><p>The protocol related structs and enums.</p>
<h1 id="protocol-specification" class="section-header"><a href="#protocol-specification">Protocol Specification</a></h1>
<p>The communication between the services is done using the abstraction of
<code>std::sync::mpsc::channel</code>. The messages are serialized and then sent inside a <code>channel</code>. The
way the messages are serialized is unspecified and
<a href="../../task_maker_exec/fn.serialize_into.html"><code>serialize_into</code></a>/<a href="../../task_maker_exec/fn.deserialize_from.html"><code>deserialize_from</code></a>
should be used instead of reading from / writing to the channels.</p>
<p>There are 3 basic actors in the protocol:</p>
<ul>
<li>The Client: the one who makes the DAG and is interested in the results;</li>
<li>The Server: the one who manages the execution of the DAGs;</li>
<li>The Worker: the one who is able to run an <code>Execution</code> inside a <code>Sandbox</code>.</li>
</ul>
<p>The clients are able to communicate to the server, the workers are able to communicate to the
server and the server is able to communicate with both. The clients and the workers should not
communicate directly.</p>
<p>The 4 valid communication directions are:</p>
<ul>
<li><code>Client</code> — <a href="enum.ExecutorClientMessage.html"><code>ExecutorClientMessage</code></a> → <code>Server</code></li>
<li><code>Client</code> ← <a href="enum.ExecutorServerMessage.html"><code>ExecutorServerMessage</code></a> — <code>Server</code></li>
<li><code>Worker</code> — <a href="enum.WorkerClientMessage.html"><code>WorkerClientMessage</code></a> → <code>Server</code></li>
<li><code>Worker</code> ← <a href="enum.WorkerServerMessage.html"><code>WorkerServerMessage</code></a> — <code>Server</code></li>
</ul>
<p>When an actor needs a file a particular series of messages is sent. Let's assume <code>A</code> wants a
file from <code>B</code>:</p>
<ul>
<li><code>A</code> sends a <code>AskFile</code> to <code>B</code></li>
<li><code>B</code> answers with <code>ProvideFile</code> which triggers a protocol switch, into FileProtocol</li>
<li><code>B</code> sends <a href="enum.FileProtocol.html#variant.Data"><code>FileProtocol::Data</code></a> zero or more times</li>
<li><code>B</code> sends <a href="enum.FileProtocol.html#variant.End"><code>FileProtocol::End</code></a> which triggers a protocol
switch, back into normal mode</li>
</ul>
</div><h2 id='structs' class='section-header'><a href="#structs">Structs</a></h2>
<table><tr class='module-item'><td><a class="struct" href="struct.ChannelFileIterator.html" title='task_maker_exec::proto::ChannelFileIterator struct'>ChannelFileIterator</a></td><td class='docblock-short'><p>An iterator over the byte chunks sent during the FileProtocol mode in a channel.</p>
</td></tr><tr class='module-item'><td><a class="struct" href="struct.ChannelFileSender.html" title='task_maker_exec::proto::ChannelFileSender struct'>ChannelFileSender</a></td><td class='docblock-short'><p>Utility function to send a file to a channel using <a href="enum.FileProtocol.html"><code>FileProtocol</code></a>.</p>
</td></tr></table><h2 id='enums' class='section-header'><a href="#enums">Enums</a></h2>
<table><tr class='module-item'><td><a class="enum" href="enum.ExecutorClientMessage.html" title='task_maker_exec::proto::ExecutorClientMessage enum'>ExecutorClientMessage</a></td><td class='docblock-short'><p>Messages that the client sends to the server.</p>
</td></tr><tr class='module-item'><td><a class="enum" href="enum.ExecutorServerMessage.html" title='task_maker_exec::proto::ExecutorServerMessage enum'>ExecutorServerMessage</a></td><td class='docblock-short'><p>Messages that the server sends to the client.</p>
</td></tr><tr class='module-item'><td><a class="enum" href="enum.FileProtocol.html" title='task_maker_exec::proto::FileProtocol enum'>FileProtocol</a></td><td class='docblock-short'><p>Messages sent during the FileProtocol operation, during the transfer of a file.</p>
</td></tr><tr class='module-item'><td><a class="enum" href="enum.WorkerClientMessage.html" title='task_maker_exec::proto::WorkerClientMessage enum'>WorkerClientMessage</a></td><td class='docblock-short'><p>Messages sent by the workers to the server.</p>
</td></tr><tr class='module-item'><td><a class="enum" href="enum.WorkerServerMessage.html" title='task_maker_exec::proto::WorkerServerMessage enum'>WorkerServerMessage</a></td><td class='docblock-short'><p>Messages sent by the server to the worker.</p>
</td></tr></table></section><section id="search" class="content hidden"></section><section class="footer"></section><script>window.rootPath = "../../";window.currentCrate = "task_maker_exec";</script><script src="../../aliases.js"></script><script src="../../main.js"></script><script defer src="../../search-index.js"></script></body></html>